@inherits DynamicComponentContainer


<MudFab Icon="@Icons.Material.Filled.Chat" Color="Color.Primary" @onclick="ToggleChat"
        Style="position:fixed; bottom: 20px; right: 20px; z-index: 100;" />

<MudPopover Open="@isChatOpen" AnchorOrigin="Origin.BottomRight" TransformOrigin="Origin.BottomRight">
    <!-- OffsetX="-40px" OffsetY="-20px">-->
    <MudPaper Class="chat-box">
        <MudCard>
            <MudCardHeader>
                <MudText Typo="Typo.h6">Chat with Us</MudText>
                <MudIconButton Icon="@Icons.Material.Filled.Close" @onclick="CloseChat" />
            </MudCardHeader>
            <MudCardContent Class="chat-content">
                <MudList>
                    @foreach (var message in messages)
                    {
                        <MudListItem>
                            <MudText>@message</MudText>
                        </MudListItem>
                    }
                </MudList>
            </MudCardContent>
            <MudCardActions Class="chat-input">
                <MudTextField @bind-Value="currentMessage" Placeholder="Type a message..." FullWidth="true" />
                <MudIconButton Icon="@Icons.Material.Filled.Send" @onclick="SendMessage" />
            </MudCardActions>
        </MudCard>
    </MudPaper>
</MudPopover>

@code {
    private bool isChatOpen = false;
    private List<string> messages = new();
    private string currentMessage;

    private void ToggleChat() => isChatOpen = !isChatOpen;

    private void CloseChat() => isChatOpen = false;

    private void SendMessage()
    {
        if (!string.IsNullOrWhiteSpace(currentMessage))
        {
            messages.Add(currentMessage);
            currentMessage = string.Empty;
        }
    }
}
